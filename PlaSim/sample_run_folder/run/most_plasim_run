#!/bin/bash
# run-script generated by Most Thu May 16 18:27:14 2024
EXP=MOST    # Name your experiment here
YEAR1=1
YEAR2=250
average="-m"  # Comment this line if you do not want monthly averaging
srv2nc=/cluster/work/gfd/jrogger/plasim-lsg/V7_revisions_chapterII/PLASIM-master/scripts/srv2nc
[ $# == 1 ] && cd $1
rm -f plasim_restart
rm -f Abort_Message
mkdir -p output
mkdir -p restart
for ((YEAR=$YEAR1; YEAR<=$YEAR2; YEAR++)); do 
   DATANAME=`printf '%s_PLA.%04d.nc' $EXP $YEAR`
   OCENAME=`printf '%s_OCE.%04d.nc' $EXP $YEAR`
   ICENAME=`printf '%s_ICE.%04d.nc' $EXP $YEAR`
   LSGNAME=`printf '%s_LSG.%04d.nc' $EXP $YEAR`
   DIAGNAME=`printf '%s_DIAG.%04d.txt' $EXP $YEAR`
   RESTNAME=`printf '%s_REST.%04d' $EXP $YEAR`
   LSGRESTNAME=`printf '%s_LSGREST.%04d' $EXP $YEAR`
   mpiexec -np 8 ./most_plasim_t42_l10_p8.x
   [ -e Abort_Message ] && exit 1
   [ -e plasim_diag ] && mv plasim_diag output/$DIAGNAME
   [ -e plasim_output ] && $srv2nc $average plasim_output output/$DATANAME
   [ -e ocean_output ] && $srv2nc $average ocean_output output/$OCENAME
   [ -e ice_output ] && $srv2nc $average ice_output output/$ICENAME
   [ -e lsg_output ] && $srv2nc lsg_output output/$LSGNAME
   [ -e plasim_status ] && cp plasim_status plasim_restart
   [ -e plasim_status ] && mv plasim_status restart/$RESTNAME
   [ -e mat77 ] && cp mat77 restart/mat77
   [ -e kleiswi ] && cp kleiswi restart/kleiswi
   [ -e kleiin1 ] && cp kleiin1 restart/$LSGRESTNAME
done
